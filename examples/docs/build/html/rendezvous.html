


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Rendezvous &mdash; PyTorch/Elastic master documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <div class="ecosystem-dropdown">
              <a id="dropdownMenuButton" data-toggle="ecosystem-dropdown">
                Ecosystem
              </a>
              <div class="ecosystem-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/hub"">
                  <span class=dropdown-title>Models (Beta)</span>
                  <p>Discover, publish, and reuse pre-trained models</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/ecosystem">
                  <span class=dropdown-title>Tools & Libraries</span>
                  <p>Explore the ecosystem of tools and libraries</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <div class="resources-dropdown">
              <a id="resourcesDropdownButton" data-toggle="resources-dropdown">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/resources"">
                  <span class=dropdown-title>Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/features">
                  <span class=dropdown-title>About</span>
                  <p>Learn about PyTorch’s features and capabilities</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  master 
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">PyTorch Elastic</a></li>
</ul>
<p class="caption"><span class="caption-text">Runtime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="aws.html">torchelastic on AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="azure.html">torchelastic on Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">torchelastic on Kubernetes</a></li>
</ul>
<p class="caption"><span class="caption-text">torchelastic core API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="checkpoint.html">Checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Rendezvous</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/rendezvous.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="rendezvous">
<h1>Rendezvous<a class="headerlink" href="#rendezvous" title="Permalink to this headline">¶</a></h1>
<p>In the context of torchelastic we use the term “rendezvous” to refer to
a particular functionality that combines a <strong>distributed
synchronization</strong> primitive with <strong>peer discovery</strong>.</p>
<p>It is used by torchelastic to gather participants of a training job
(i.e. workers) such that they all agree on the same list of participants
and everyone’s roles, as well as make a consistent collective decision
on when training can begin/resume.</p>
<p>Torchelastic Rendezvous provides the following critical functionalities:</p>
<div class="section" id="barrier">
<h2>Barrier<a class="headerlink" href="#barrier" title="Permalink to this headline">¶</a></h2>
<p>Workers performing rendezvous will all block until the rendezvous is
considered complete - this happens when at least <code class="docutils literal notranslate"><span class="pre">min</span></code> total number of
workers have joined the rendezvous barrier (for the same job). This also
implies the barrier is not necessarily of fixed size.</p>
<p>There’s an additional small waiting time after reaching <code class="docutils literal notranslate"><span class="pre">min</span></code> number
of workers - this is used to ensure the rendezvous is not completed “too
quickly” (which could potentially exclude additional workers attempting
to join at approximately the same time).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">max</span></code> number of workers is gathered at the barrier, the rendezvous
is completed immediately.</p>
<p>There’s also an overall timeout which causes the rendezvous to fail if
<code class="docutils literal notranslate"><span class="pre">min</span></code> number of workers is never reached – this is meant to be a
simple fail-safe to help release partially allocated job resources, in
case there’s a problem with the resource manger, and is meant to be
interpreted as non-retryable.</p>
</div>
<div class="section" id="exclusivity">
<h2>Exclusivity<a class="headerlink" href="#exclusivity" title="Permalink to this headline">¶</a></h2>
<p>A simple distributed barrier would not be sufficient, as we also need to
ensure that only one group of workers exists at any given time (for a
given job). In other words, new workers (i.e. joining late) should not
be able to form a parallel independent group of workers for the same
job.</p>
<p>Torchelastic rendezvous ensures that if a group of workers has already
completed a rendezvous (and hence might already be training), then
additional “late” workers attempting to rendezvous will only announce
themselves as waiting, and will have to wait until the (previously
completed) existing rendezvous is destroyed first.</p>
</div>
<div class="section" id="consistency">
<h2>Consistency<a class="headerlink" href="#consistency" title="Permalink to this headline">¶</a></h2>
<p>When a rendezvous is completed, all its members will agree on the job
membership and everyone’s role in it. This role is represented using an
integer, called rank, that is between between 0 and world size.</p>
<p>Note that ranks are <em>not stable</em>, in the sense that the same worker
process can be assigned a different rank in the next (re-)rendezvous.</p>
</div>
<div class="section" id="fault-tolerance">
<h2>Fault-tolerance<a class="headerlink" href="#fault-tolerance" title="Permalink to this headline">¶</a></h2>
<p>Torchelastic rendezvous is designed to tolerate worker failures during
the rendezvous process. Should a process crash (or lose network
connectivity, etc), between joining the rendezvous and it being
completed, then a re-rendezvous with remaining healthy workers will
happen automatically.</p>
<p>A worker can also fail <em>after</em> it has completed (or <em>has been
observered</em> by other workers to have completed) the rendezvous - this
scenario will be handled by the torchelastic <code class="docutils literal notranslate"><span class="pre">train_loop</span></code> instead
(where it will also trigger a re-rendezvous).</p>
</div>
<div class="section" id="shared-key-value-store">
<h2>Shared key-value store<a class="headerlink" href="#shared-key-value-store" title="Permalink to this headline">¶</a></h2>
<p>When the rendezvous is completed, a shared key-value store is created
and returned. This store implements a <code class="docutils literal notranslate"><span class="pre">torch.distributed.Store</span></code> API
(see <a class="reference external" href="https://pytorch.org/docs/stable/distributed.html">distributed communication
docs</a>).</p>
<p>This store is only shared by the members of the completed rendezvous. It
is intended to be used by torchelastic to exchange information necessary
to initialize job control and data-planes.</p>
</div>
<div class="section" id="waiting-workers-and-rendezvous-closing">
<h2>Waiting workers and rendezvous closing<a class="headerlink" href="#waiting-workers-and-rendezvous-closing" title="Permalink to this headline">¶</a></h2>
<p>Torchelastic rendezvous handler object provides additional
functionalities, which are technically not part of the rendezvous
process: * Querying how many workers arrived late at the barrier, who
can participate in <em>next</em> rendezvous. * Setting the rendezvous <em>closed</em>
to signal all workers not to participate in next rendezvous.</p>
</div>
<div class="section" id="interface">
<h2>Interface:<a class="headerlink" href="#interface" title="Permalink to this headline">¶</a></h2>
<p>Torchelastic rendezvous has the following interface: <strong>WARNING:</strong>
torchelastic is currently considered experimental, so the APIs may
change!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RendezvousHandler</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">next_rendezvous</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;torch.distributed.Store&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">pass</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">is_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">num_nodes_waiting</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">RendezvousClosedException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">RendezvousTimeoutException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">RendezvousNonRetryableError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">next_rendezvous</span></code> is the main entry-point into the rendezvous
barrier. It blocks until the rendezvous is complete (and the current
process is included in the formed worker group), or a timeout occurs, or
rendezvous was marked closed.</p>
<p>Retuned value is a triplet <code class="docutils literal notranslate"><span class="pre">(store,</span> <span class="pre">rank,</span> <span class="pre">world_size)</span></code>. If a timeout
occurs, <code class="docutils literal notranslate"><span class="pre">RendezvousTimeoutException</span></code> is raised. If the rendezvous for
current job is closed, <code class="docutils literal notranslate"><span class="pre">RendezvousClosedException</span></code> is raised.</p>
<p><code class="docutils literal notranslate"><span class="pre">is_closed</span></code> checks whether rendezvous for current job has been closed,
which means all future attempts to re-rendezvous (within same job) will
fail.</p>
<p><code class="docutils literal notranslate"><span class="pre">set_closed</span></code> is used to mark the rendezvous (for current job) as
closed.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">is_closed</span></code>/<code class="docutils literal notranslate"><span class="pre">set_closed</span></code> have semantics of eventual
propagation, and should not be used for synchronization. The intention
here is that if at least one worker decides the job is finished, it will
close the rendezvous, and other workers will “soon” observe this and
stop training/rendezvous-ing as well.</p>
<p><code class="docutils literal notranslate"><span class="pre">num_nodes_waiting</span></code> returns number of workers who <em>arrived late</em> at
the rendezvous barrier, hence weren’t included in the current worker
group. Torchelastic <code class="docutils literal notranslate"><span class="pre">train_loop</span></code> will periodically check
<code class="docutils literal notranslate"><span class="pre">num_nodes_waiting</span></code>, and may decide to pause training in order to
re-rendezvous and include these additional workers.</p>
<p><strong>NOTE:</strong> Torchelastic users normally <strong>do not</strong> need to implement their
own <code class="docutils literal notranslate"><span class="pre">RendezvousHandler</span></code>. An implementation based on
<a class="reference external" href="https://etcd.io/">etcd</a> is already provided, and is recommended for
most users, provided they can deploy it in their environment.</p>
</div>
<div class="section" id="etcd-rendezvous">
<h2>Etcd Rendezvous<a class="headerlink" href="#etcd-rendezvous" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">etcd_rendezvous</span></code> implementation in torchelastic uses
<a class="reference external" href="https://etcd.io/">etcd</a> as the backend store. You can see the full
implementation in <a class="reference external" href="etcd_rendezvous.py">etcd_rendezvous.py</a>. Below is
a state diagram of how it works, <img alt="etcd rendezvous state diagram" src="_images/etcd_rdzv_diagram.png" /></p>
<p>Torchelastic uses a URL to configure the type of rendezvous to use and
to pass implementation specific configurations to the rendezvous module.
The basic etcd rendezvous configuration URL looks like the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>etcd://&lt;etcd_address&gt;:&lt;port&gt;/&lt;job_id&gt;?min_workers=&lt;min_workers&gt;&amp;max_workers=&lt;max_workers&gt;

-- example --

etcd://localhost:2379/1234?min_workers=1&amp;max_workers=3
</pre></div>
</div>
<p>The URL above is passed to the constructor of the <code class="docutils literal notranslate"><span class="pre">Coordinator</span></code> and it
is interpreted as the following:</p>
<ol class="arabic simple">
<li><p>Use the rendezvous handler that is registered with the <code class="docutils literal notranslate"><span class="pre">etcd</span></code>
scheme</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">etcd</span></code> endpoint to use is <code class="docutils literal notranslate"><span class="pre">localhost:2379</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">job_id</span> <span class="pre">==</span> <span class="pre">1234</span></code> is used as the prefix in etcd (this allows one to
share a common etcd server for multiple jobs so long as the
<code class="docutils literal notranslate"><span class="pre">job_ids</span></code> are guaranteed to be unique). Note that the job id can be
any string (e.g. does not need to be a number) as long as it is
unique.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_workers=1</span></code> and <code class="docutils literal notranslate"><span class="pre">max_workers=3</span></code> specifies a range for
membership size - torchelastic starts running the job as long as the
cluster size is greater than or equal to <code class="docutils literal notranslate"><span class="pre">min_workers</span></code> and admits
up to <code class="docutils literal notranslate"><span class="pre">max_workers</span></code> into the cluster.</p></li>
</ol>
<p>Below are a full list of the parameters that can be passed to etcd
rendezvous</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 63%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>min_workers</p></td>
<td><p>minimum number of
workers for the
rendezvous to be valid</p></td>
</tr>
<tr class="row-odd"><td><p>max_workers</p></td>
<td><p>maximum number of
workers to admit</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>total timeout within
which next_rendezvous is
expected to succeed
(default 600s)</p></td>
</tr>
<tr class="row-odd"><td><p>last_call_timeout</p></td>
<td><p>additional wait amount
(“last call”) after min
number of workers has
been reached (defaults
to 30s)</p></td>
</tr>
<tr class="row-even"><td><p>etcd_prefix</p></td>
<td><p>path prefix (from etcd
root), inside which all
etcd nodes will be
created (defaults to
<code class="docutils literal notranslate"><span class="pre">/torchelastic/p2p</span></code>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="custom-rendezvous">
<h2>Custom Rendezvous<a class="headerlink" href="#custom-rendezvous" title="Permalink to this headline">¶</a></h2>
<p>You must do the following to implement and use a custom rendezvous
implementation,</p>
<ol class="arabic simple">
<li><p>Implement the <a class="reference external" href="api.py">RendezvousHandler</a> interface.</p></li>
<li><p>Register the custom handler with
<code class="docutils literal notranslate"><span class="pre">torch.distributed.register_rendezvous_handler()</span></code></p></li>
<li><p>Ensure that the registration happens before any calls to load the
rendezvous object.</p></li>
</ol>
<p>For an example, refer to
<code class="docutils literal notranslate"><span class="pre">`etcd_rendezvous.py</span></code> &lt;etcd_rendezvous.py&gt;`__.</p>
</div>
</div>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, PyTorch Elastic Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Rendezvous</a><ul>
<li><a class="reference internal" href="#barrier">Barrier</a></li>
<li><a class="reference internal" href="#exclusivity">Exclusivity</a></li>
<li><a class="reference internal" href="#consistency">Consistency</a></li>
<li><a class="reference internal" href="#fault-tolerance">Fault-tolerance</a></li>
<li><a class="reference internal" href="#shared-key-value-store">Shared key-value store</a></li>
<li><a class="reference internal" href="#waiting-workers-and-rendezvous-closing">Waiting workers and rendezvous closing</a></li>
<li><a class="reference internal" href="#interface">Interface:</a></li>
<li><a class="reference internal" href="#etcd-rendezvous">Etcd Rendezvous</a></li>
<li><a class="reference internal" href="#custom-rendezvous">Custom Rendezvous</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script type="text/javascript" src="_static/jquery.js"></script>
         <script type="text/javascript" src="_static/underscore.js"></script>
         <script type="text/javascript" src="_static/doctools.js"></script>
         <script type="text/javascript" src="_static/language_data.js"></script>
         <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
         <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
         <script type="text/javascript" src="_static/katex_autorenderer.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://pytorch.org/resources">Resources</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/support">Support</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.slack.com" target="_blank">Slack</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/features">Features</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/hub">PyTorch Hub</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>